//****************************************************************************
//
// MSP432 main.c template - Empty main
//
//****************************************************************************

#include "msp.h"
#include "delay.h"
#include "stdio.h"

#define RS BIT7
#define RW BIT6
#define E BIT5
#define DB3 BIT3
#define DB2 BIT2
#define DB1 BIT1
#define DB0 BIT0


send_cmd(int CMD)
{
    P4->OUT &= ~(RS + RW + E + DB3 + DB2 + DB1 + DB0);
     delay_us(1); //Be Safe
     P4->OUT |= E;
     P4->OUT |= ((CMD >> 4 ) & 0x0F);
     delay_us(1); // Hold E
     P4->OUT &= ~E;
     delay_us(1);
     if (CMD == FUNC_SET)
     {
     P4 ->OUT &= ~(RS + RW + E + DB3 + DB2 + DB1 + DB0);
     delay_us(1); //Be Safe
     P4->OUT |= E;
     P4->OUT |= ((CMD >> 4 ) & 0x0F);
     delay_us(1); // Hold E
     P4->OUT &= ~E;
     delay_us(1);

    }

     P4-> OUT &= ~(RS + RW + E + DB3 + DB2 + DB1 + DB0);
     delay_us(1);
     P4-> OUT |=E;
     P4-> OUT |= CMD & 0x0F;
     delay_us(1);
     P4-> OUT &= ~E;
     delay_us(1);
     P4-> OUT &= ~(RS + RW + E + DB3 + DB2 + DB1 + DB0);


}

void main(void)
{
    WDTCTL = WDTPW | WDTHOLD;           // Stop watchdog timer

    P4-> DIR |= RS + RW + E + DB7 + DB6 + DB5 + DB4;
    send_cmd(FUNC_SET);
    delay_us(37);
    send_cmd(0X0F);    //set display
    delay_us(37);
    send_cmd(0x01);    //clear
    delay_ms(2);






}
